<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="854" MadCap:lastWidth="628" MadCap:fileTags="ReleaseTarget.CTP1,TopicOwner.v-ssiera,EditingTags.7 - Editing issues resolved,Status.70 - Complete" MadCap:conditions="API.APIRef">
    <head>
        <link href="../../Resources/Stylesheets/AmalgaMain.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>Prepare the <MadCap:variable name="BrandingHSG.Brussels second use" /> client</h1>
        <p>&#160;</p>
        <p class="warning">The Doors gacutil.exe utility distributed with <MadCap:variable name="BrandingHSG.AmalgaV3 first use" /> is provided under the Amalga Preview License.  You may use it only as part of <MadCap:variable name="BrandingHSG.AmalgaV3 first use" />.</p>
        <p>The List Management OLE DB Provider and the Report Builder application must be installed on any client machine accessing the <MadCap:variable name="BrandingHSG.Brussels second use" /> to create reports using <MadCap:variable name="BrandingMS.Report Builder" />.</p>
        <p class="LabelforProcedures">To install prerequisites for List Management OLE DB&#160;Provider</p>
        <ol>
            <li>Install the <MadCap:variable name="BrandingMS..NET4.0" />.<ul><li><p><a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=17718">http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=17718</a></p></li></ul></li>
            <li>Install <MadCap:variable name="BrandingMS.Visual Studio 2010 second use" /> C++ redistributable.<ul><li><p>(for x64) <a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;amp;id=14632">http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=14632</a></p></li><li><p>(for x86) <a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;amp;id=5555">http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=5555</a></p></li></ul></li>
            <li>Install the Doors Identity Foundation<ul><li><p><a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;amp;id=17331">http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=17331</a></p></li></ul></li>
            <li>From your installation media, locate and run the following: Microsoft.Health.DataAccessRuntime32.msi.</li>
            <li>Install Microsoft SQL Server 2008 R2 Report Builder 3.0.<ul><li><p><a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;amp;id=6116">http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=6116</a></p></li></ul></li>
            <li>
                <p>Add the following appSettings section to the Report Builder 3.0 configuration file (located in Program Files\Microsoft SQL Server\Report Builder 3.0\MSReportBuilder.exe.config)</p>
                <p class="code">&lt;configuration&gt;</p>
                <p class="code">...</p>
                <p class="code">&lt;appSettings&gt;</p>
                <p class="code">&lt;add key="ConnectToV3DataAccessLayer" value="true" /&gt;</p>
                <p class="code">&lt;/appSettings&gt;</p>
                <p class="code">&lt;/configuration&gt;</p>
            </li>
        </ol>
        <p class="LabelforProcedures">To install the List Management OLE DB Provider         </p>
        <ol>
            <li>Create a folder on the same drive where your Doors System folder is located, called c:\<MadCap:variable name="BrandingHSG.Amalga Short" /> Install.</li>
            <li>Copy the contents of the Packages folder from your <MadCap:variable name="BrandingHSG.Amalga Long" /> distribution CD to the folder you created in step 1.</li>
            <li>From the folder you created in step 1, locate and run the following: Microsoft.Health.DataAccessRuntime32.msi. It can be found in the en-us folder located in the Packages folder.</li>
            <li>Open a Command Prompt window with administrator level permissions.</li>
            <li>Navigate to the folder you created in step 1.</li>
            <li>Run InstallListManagementOLEDBProvider.cmd </li>
        </ol>
        <p>You can configure the default sort order for the list and the number of patients to display in the list. When there are no  keys in the file, by default, the list will be limited to 50 patients and sorted in ascending order by FullName (a-Z).</p>
        <p class="LabelforProcedures">To configure list options</p>
        <ol>
            <li>In <MadCap:variable name="BrandingMS.SharePoint"></MadCap:variable> Server, locate the web.config file in C:\Inetpub\wwwroot\wss\VirtualDirectories\ Port_Number</li>
            <li>
                <p>Add the following two keys to the file, inside <span class="ForeignCodeElements">the &lt;appSettings&gt; &lt;/appSettings&gt;</span> node:</p>
                <ol style="list-style-type: lower-alpha;">
                    <li>MaximumNumberRowsCTP</li>
                    <li>
                        <p>OrderBy</p>
                    </li>
                </ol>
                <p>For example, these settings will limit all patient lists to 100 patients and the list will be sorted by DateofBirth in ascending order:</p>
                <ol style="list-style-type: lower-alpha;">
                    <p class="code">&lt;add key="MaximumNumberRowsCTP" value="100" /&gt;</p>
                    <p class="code">&lt;add key="OrderBy" value="DateOfBirth ASC" /&gt;</p>
                </ol>
            </li>
        </ol>
    </body>
</html>