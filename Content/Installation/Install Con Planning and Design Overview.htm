<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="4" MadCap:lastHeight="3841" MadCap:lastWidth="660" MadCap:fileTags="ReleaseTarget.CTP1,Status.70 - Complete,TopicType.Overview/Introduction,Personas.Carlos: IT Admin,TopicOwner.v-ssiera" MadCap:conditions="Region.US">
    <head>
        <link href="../Resources/Stylesheets/AmalgaMain.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>Topology concepts</h1>
        <p class="PersonaAll">&#160;</p>
        <p>This section contains information on the <MadCap:variable name="BrandingHSG.Amalga Short" /> topology.</p>
        <p MadCap:conditions="Production.doNOTbuild">
            <MadCap:annotation MadCap:createDate="2011-11-17T22:07:54.6014980-08:00" MadCap:creator="v-keith" MadCap:initials="KH" MadCap:comment="These sections DNB'd as things changed in the CTP process. Coexistence will have have to be covered in future releases." MadCap:editor="v-keith" MadCap:editDate="2011-11-17T22:09:06.4564808-08:00">Defining</MadCap:annotation> the appropriate Setup commands for an <MadCap:variable name="BrandingHSG.AmalgaV3 first use" /> installation requires that the topology be designed in advance so that the Setup commands create the desired topology. This section provides the information necessary to design a topology. A complete understanding of the physical implementation of a topology and subsequent <MadCap:variable name="BrandingHSG.Amalga Short" /> installation requires a detailed knowledge of the <MadCap:variable name="BrandingHSG.Amalga Short" /> logical architecture described in <MadCap:xref href="../Amalga_PlatformSDK/SDK_OVW_Platform_Arch_For_Developers.htm" target="" title="" alt="">Amalga Platform Development Architecture</MadCap:xref>.</p>
        <h2 MadCap:conditions="Production.doNOTbuild"><MadCap:variable name="BrandingHSG.Amalga Short" />
            <MadCap:annotation MadCap:createDate="2011-08-31T00:37:56.8568325-07:00" MadCap:creator="v-ciwyco" MadCap:initials="CJW" MadCap:comment="Internal-only shorthand -- do not use.  Discussing alternatives Thurs 9/1.\r\nThere is a variable for Amalga V3.\r\n\r\nKH: OK, standing by for the alternative.\r\n\r\nCJW; Alternative is the AmalgaV2 variable " MadCap:editor="v-ciwyco" MadCap:editDate="2011-10-24T22:28:02.6079429-07:00">— <MadCap:variable name="BrandingHSG.AmalgaV2" /></MadCap:annotation> coexistence</h2>
        <p MadCap:conditions="Production.doNOTbuild">
            <img src="Images/V2V3Coexistence2.png" style="float: right;width: 317px;height: 260px;" />Although <MadCap:variable name="BrandingHSG.Amalga Short" /> is a standalone platform, it is designed to run side by side with <MadCap:variable name="BrandingHSG.Amalga Short" /> V2 with both accessing the clinical data simultaneously. The intention is to preserve the existing V2 investment and allow a managed transition of V2 custom functions (such as parsers) to V3 over time. There are no specific configuration requirements to allow this capability other than specifying the correct V2 instance name for the <span class="Parameter">ClinicalDataDBServerInstance</span> parameter during the installation of the DataPipelineStorage feature.</p>
        <p class="caution" MadCap:conditions="Production.doNOTbuild">Installation of A<MadCap:annotation MadCap:createDate="2011-08-31T20:07:00.6665636-07:00" MadCap:creator="v-ciwyco" MadCap:initials="CJW" MadCap:comment="The Amalga V2 and V3 in the diagram will need to be replaced  to Amalga UIS and (until we know for sure what V3 is called) Microsoft Amalga.\r\n\r\nKH: Got it, back burner for CTP." MadCap:editor="v-keith" MadCap:editDate="2011-09-21T20:37:48.4563453-07:00">malga V2 and V3</MadCap:annotation> platform and application components on the same servers is not supported. The client components may run concurrently on the same workstation.</p>
        <h2><MadCap:variable name="BrandingHSG.AmalgaV3 first use" /> physical architecture concepts</h2>
        <p>Logical hosts replace the Server Role concept of <MadCap:variable name="BrandingHSG.Amalga Short" /> V2 as the central unit of an <MadCap:variable name="BrandingHSG.Amalga Short" /> V3 implementation and contain pools of services or applications. A logical host is a configuration and management abstraction that does not correspond with  a physical implementation. All of the machines, either physical or virtual within a logical host are treated as a unit during application deployment and topology management functions. As a result, instead of deploying a newly developed application to a specific physical machine, you deploy the application to a logical host. <MadCap:variable name="BrandingHSG.Amalga Short" /> platform services then manage the deployment of that application onto the physical and virtual machines within the logical host.</p>
        <p>
            <img src="Images/LogicalHost1.png" style="float: right;width: 191px;height: 136px;padding-left: 12px;" />Logical hosts can be of three types: Failover, Network Load Balancing (NLB), or none.</p>
        <p>All <MadCap:variable name="BrandingHSG.Amalga Short" /> features and applications must be deployed onto logical hosts. They cannot be installed directly on physical machines. So, from a configuration and management perspective, all features and applications are linked to logical hosts rather than physical hosts. The benefits of this abstraction are realized through simplified installation and management.</p>
        <ul>
            <li>Single servers, failover clusters, and Network Load Balancing (NLB) servers are handled identically when deploying and managing applications and features.</li>
            <li>The physical infrastructure underlying the logical hosts can be changed while preserving the logical view at the administrative level.</li>
            <li>Migrating applications and platform features to balance the topology for operational or performance requirements is easier since the links are maintained at the level of the logical host. </li>
        </ul>
        <p>The <MadCap:variable name="BrandingHSG.Amalga Short" /> topology is constructed by combining logical hosts that will contain the <MadCap:variable name="BrandingHSG.Amalga Short" /> features. From an installation point of view, there are several <MadCap:variable name="BrandingHSG.Amalga Short" /> features that need to be placed within the architecture depending on the desired implementation. For more information on the features and their installation, see the <MadCap:xref href="Install Con Installtn Overview.htm" target="" title="" alt="">Installation overview</MadCap:xref>.</p>
        <p>&#160;</p>
        <h2><MadCap:variable name="BrandingHSG.Amalga Short" /> example topology</h2>
        <p MadCap:conditions="Production.doNOTbuild"><MadCap:variable name="BrandingHSG.Amalga Short" /> is designed to support a high availability implementation;  this has significant implications for the topology implementation. This section describes the <MadCap:variable name="BrandingHSG.Amalga Short" /> high availability reference topology and descriptions of the various components. The reference topology is the minimum configuration that will support the levels of availability required in medical systems.</p>
        <p>Several general design principles were considered in the design of the example topology.</p>
        <ul>
            <li>Virtual machines are used in areas other than storage clusters to allow for operational flexibility and the ability to add additional application or service instances as required.</li>
            <li>All logical hosts have failure protection at the virtual and physical machine levels. The virtual machines can be <MadCap:annotation MadCap:createDate="2011-08-31T22:02:02.1354744-07:00" MadCap:creator="v-ciwyco" MadCap:initials="CJW" MadCap:comment="Awkward -- is there another way to say this?\r\n\r\nKH: IMHO, this is accepted usage for our audience. I'd like to leave it unless it makes you too crazy." MadCap:editor="v-keith" MadCap:editDate="2011-09-21T21:56:07.2334708-07:00">failed-over </MadCap:annotation>to support system software updates at the logical host level, and physical servers can be upgraded or replaced while keeping the virtual machines active on other servers.</li>
            <li>Failover clusters are required for all logical hosts supporting <MadCap:variable name="BrandingMS.SQL Server" /> activity to support availability and performance. Additionally, they may be used to support applications that contain services designed to run on a failover cluster.</li>
            <li>Network Load Balancing (NLB) implementations are used for all non-<MadCap:variable name="BrandingMS.SQL Server" /> logical hosts to support improving performance by adding additional cluster nodes or physical machines. NLB clusters can also be used to support applications containing services that are designed for a NLB cluster.</li>
        </ul>
        <p>Although the example topology represents an integrated system, it is described here in two sections. The first section describes the topology that supports primarily applications and services and whose logical hosts can include virtual machines. The second section describes storage logical machines and their requirement to be hosted on standalone physical servers.</p>
        <p>&#160;</p>
        <p MadCap:conditions="Production.ScreenOnly">
            <img src="Images/MultiBoxTopology2.png" />
        </p>
        <p MadCap:conditions="Production.PrintOnly">
            <img src="Images/MultiBoxTopology2.png" style="width: 519px;height: 407px;" />
        </p>
        <h3>Applications and services topology</h3>
        <p>The example topology consists of two physical machines supporting multiple virtual machines. Those virtual machines are organized into six logical hosts. The logical hosts and their recommended implementations follow.</p>
        <h6 style="font-size: 10pt;"><MadCap:variable name="BrandingMS.SharePoint" /> servers</h6>
        <p><MadCap:variable name="BrandingMS.SharePoint" /> provides both web and application server roles from two logical hosts.</p>
        <p>The <MadCap:variable name="BrandingMS.SharePoint" /> web server is shown as a physically separate installation from the <MadCap:variable name="BrandingHSG.Amalga Short" /> topology to demonstrate an option for the web server to reside outside the firewall for additional security. If only <MadCap:variable name="BrandingHSG.Amalga Short" /> users will connect through the web server, it can be included in the <MadCap:variable name="BrandingMS.SharePoint" /> application server logical host. Combining the <MadCap:variable name="BrandingMS.SharePoint" /> web and  application servers is not recommended because of the increased possibility of performance problems.</p>
        <p>The <MadCap:variable name="BrandingHSG.Amalga Short" /> <![CDATA[ ]]><MadCap:variable name="BrandingMS.SharePoint" /> application servers should be deployed in a logical host of type NLB and should be configured in line with published guidelines for scaling <MadCap:variable name="BrandingMS.SharePoint" /> implementations. For more information, see <a href="http://go.microsoft.com/fwlink?LinkID=227559" MadCap:conditions="Production.ScreenOnly">SharePoint scaling</a> <![CDATA[ ]]><MadCap:conditionalText MadCap:conditions="Production.PrintOnly"><MadCap:variable name="BrandingMS.SharePoint" /> scaling at http://go.microsoft.com/fwlink?LinkID=227559</MadCap:conditionalText>.</p>
        <h6 style="font-size: 10pt;">Application services</h6>
        <p>The Application services logical host represents a pool of <MadCap:variable name="BrandingHSG.Amalga Short" /> applications. Depending on the number and type of applications implemented, there might be more than one such pool. The applications are separated from the Platform services logical host to introduce a security boundary. Additional Application Services logical hosts should also be considered for certain circumstances. </p>
        <p>For example, it may be desirable to place all of the <MadCap:variable name="BrandingHSG.Amalga Short" /> financial applications onto a separate logical host. This might be done to allow the applications to run on a less powerful server, to make it easier for IT personnel to understand where applications are running, or to provide clear separation of user access.</p>
        <p>Application Services should be implemented on a NLB logical host. There should be more than two Application Services nodes in the NLB logical host. The most costly operation for data-bound applications is typically those associated with database activities. During those periods, the application is waiting for a response from the database and other application requests may be blocked. 
By increasing the number of application instances, we can scale up the number of requests that can be in process at the same time. During a period of high demand, the requests should be spooling against the database server so that the total system latency is reduced. 
</p>
        <h6 style="font-size: 10pt;">Platform services</h6>
        <p>The Platform Services logical host supports the topology management and provides key services to the entire system. Is should be implemented as a NLB logical host.</p>
        <h6 style="font-size: 10pt;">Data ingestion services</h6>
        <p>The data ingestion logical host supports the services gathering data from external feeds, and should reside in a failover cluster with disk allocated (SAN recommended) as a queue.</p>
        <h6 style="font-size: 10pt;">Parser services</h6>
        <p>Parser services format and store the data brought in by the ingestion services and should reside on a failover logical host.</p>
        <h6 style="font-size: 10pt;">Active Directory Federation Service (ADFS)</h6>
        <p>ADFS should be implemented using high availability recommendations described in <a href="http://go.microsoft.com/fwlink?LinkID=227564" MadCap:conditions="Production.ScreenOnly">ADFS high availability planning</a><MadCap:conditionalText MadCap:conditions="Production.PrintOnly">ADFS high availability planning (http://go.microsoft.com/fwlink?LinkID=227564)</MadCap:conditionalText>. The  platform services implementation should be a NLB logical host.</p>
        <h3>Amalga storage topology</h3>
        <p>
            <img src="Images/DataStorageToplogy.png" style="float: right;vertical-align: text-top;width: 217px;height: 201px;padding-left: 10px;" />The logical host supporting the primary topology, message queue, and clinical database is unique in two aspects.</p>
        <ol>
            <li>The logical host is composed only of physical machines and cannot include virtual machines, in order to provide higher availability through physical isolation.</li>
            <li>The logical host is an active-active failover cluster in order to support increased machine utilization and higher performance.</li>
        </ol>
        <p>In addition, <MadCap:variable name="BrandingMS.SharePoint" /> storage should also be a configured in an active-passive fail-over cluster and will be separate from other <MadCap:variable name="BrandingMS.SQL Server" /> instances to insure performance. <MadCap:variable name="BrandingMS.SharePoint" /> <![CDATA[ ]]><MadCap:variable name="BrandingMS.SQL Server" /> instances should be designed in accordance with the <a href="http://go.microsoft.com/fwlink?LinkID=229357" MadCap:conditions="Production.ScreenOnly">SharePoint storage guidelines</a> <![CDATA[ ]]><MadCap:conditionalText MadCap:conditions="Production.PrintOnly"><MadCap:variable name="BrandingMS.SharePoint" /> storage guidelines (http://go.microsoft.com/fwlink/?LinkID=229357)</MadCap:conditionalText> to support the projected load.</p>
        <h2 MadCap:conditions="Production.doNOTbuild">Designing the topology</h2>
        <p MadCap:conditions="Production.doNOTbuild">Given the guidelines provided, each topology will be designed to meet the needs of a specific enterprise. The design chosen will vary depending on the enterprise's priorities regarding cost, availability, and performance. The design needs to be thoroughly mapped out prior to installation, as the Setup commands are completely dependent on the <MadCap:variable name="BrandingHSG.Amalga Short" /> topology.</p>
    </body>
</html>