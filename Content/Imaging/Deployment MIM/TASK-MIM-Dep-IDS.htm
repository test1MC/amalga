<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:fileTags="Personas.Carlos: IT Admin,TopicType.Procedure,EditingTags.7 - Editing issues resolved,TopicOwner.v-mattbr,Status.60 - Revising,ReleaseTarget.TAP" MadCap:conditions="Features.Imaging,Releases.Investigation Use" MadCap:lastBlockDepth="7" MadCap:lastHeight="859" MadCap:lastWidth="624">
    <head>
        <link href="../../Resources/Stylesheets/AmalgaMain.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>Deploy <MadCap:variable name="Imaging.Image Delivery server" /> application</h1>
        <p class="PersonaAll">&#160;</p>
        <p>
            <MadCap:keyword term="Imaging:IDA deployment" /> <![CDATA[ ]]><MadCap:variable name="Imaging.Image Delivery server" /> application (IDA) is installed on a logical host at each facility where a <MadCap:variable name="Imaging.DicomBlobData database" /> database is present.</p>
        <ul>
            <li>If the data pipeline from <MadCap:variable name="BrandingHSG.AmalgaV2" /> as it applies to <MadCap:variable name="BrandingHSG.Amalga Medical Imaging Module" />&#160;has been deployed with centralized topology, you can synchronize the IDA to one of the existing logical hosts.&#160;For an example, see AppsLogicalHost2 in the <MadCap:xref href="GREF-Central-Top.htm">Centralized topology on page 1</MadCap:xref>.</li>
            <li>If the data pipeline from <MadCap:variable name="BrandingHSG.AmalgaV2" />  as it applies to <MadCap:variable name="BrandingHSG.Amalga Medical Imaging Module" />&#160;has been deployed with distributed topology, you should synchronize the IDA to a logical host at each remote facility.&#160;For example, see ImagingAppsLogicalHost-SiteN in <MadCap:xref href="GREF-Dist-Top.htm">Distributed topology on page 1</MadCap:xref>.</li>
            <li>You must grant the account that is used by IDA access to the DicomBlobData and DicomMetaData databases. See the  <MadCap:snippetText src="../../Resources/Snippets/mref-Imaging.flsnp" /> in <MadCap:variable name="BrandingHSG.AmalgaV2" /> documentation for further details.</li>
        </ul>
        <p class="note">Refer to the installation instructions for <MadCap:variable name="BrandingHSG.Amalga Short" />-hosted applications for further details. For more information, see <MadCap:xref href="../../Serviceability/Management Console/Application Management/Application Deployment.htm">Application deployment on page 1</MadCap:xref>.</p>
        <p>After the application synchronization is complete, install the IDA on each node of the logical hosts hosting the IDA or IDAs, using these procedures.</p>
        <ol>
            <li><a href="#To resolve manifest files">Resolve manifest files.</a>
            </li>
            <li><a href="#To publish and synchronize the application">Publish and synchronize the application.</a>
            </li>
            <li>I<a href="#To install the RESTful Service">nstall the <MadCap:variable name="Imaging.Image Delivery server" /> RESTful Service.</a></li>
        </ol>
        <p>For more information on this <MadCap:variable name="BrandingMS.Doors PowerShell" /> cmdlet, see <MadCap:xref href="../../PowerShellCmdlets/PS_Ref_Publish-AmApplicatioinInstance.htm">Publish-AmApplicationInstance on page 1</MadCap:xref>.</p>
        <p class="LabelforProcedures"><a name="To resolve manifest files"></a>To resolve manifest files</p>
        <ol>
            <li>Get application and service manifest files from ImageDeliveryApplication.cab.</li>
            <li>Modify AmalgaApplication.xml.<ol style="list-style-type: lower-alpha;"><li>Add the InstanceName , for example, IDSApp_Inst1 to the <span class="XMLRequired">DeploymentManifest</span>.</li><li>Add the DataConnectorApplication instance name in the <span class="XMLRequired">Dependency </span>section.</li></ol></li>
            <li>Modify ImageDeliverySoapService.xml.<ol style="list-style-type: lower-alpha;"><li>Add InstanceName, for example, IDSSoapService_Inst1, to the DeploymentManifest.</li><li>Add LogicalHostName to WcfServiceManifest, for example, LogicalHostName = " ImagingAppsLogicalHost-SiteN " in the multisite topology.</li></ol></li>
            <li>Modify <span class="Label">ImageDeliveryCoreService.xml</span><ol style="list-style-type: lower-alpha;"><li>Add InstanceName, for example,<span class="InputText"> IDSCoreService_Inst1</span>, to the DeploymentManifest.</li></ol></li>
        </ol>
        <p class="LabelforProcedures"><a name="To publish and synchronize the application"></a>To publish and synchronize the application</p>
        <ol>
            <li>Start <MadCap:variable name="BrandingMS.Doors PowerShell" /> on a logical host where the respective IDA instance is installed. <MadCap:snippetText src="../../Resources/Snippets/proc-StartPowerShell.flsnp" /> <![CDATA[ ]]></li>
            <li>Run the following command:<p class="InputText">Import-module 'C:\Program Files\Microsoft Amalga\System 3.0\Platform\PowerShell\Microsoft.Amalga.Powershell.dll'</p></li>
            <li>Run the following command:<p class="InputText">Publish-ApplicationInstance -ApplicationCabFile <span class="InputTextVariable">ApplicationCabFilePath </span>-ApplicationAuxiliaryFiles "AppManifestFilePath; <span class="InputTextVariable">SoapServiceManifestFilePath</span>, <span class="InputTextVariable">CoreServiceManifestFilePath</span>"</p><table style="width: 95%; margin-left: 0; margin-right: auto;"><col /><col /><thead><tr><th>Placeholder	</th><th>Value</th></tr></thead><tbody><tr><td class="InputTextVariable">ApplicationCabFilePath </td><td>The full path for the IDA cab file.</td></tr><tr><td class="InputTextVariable">SoapServiceManifestFilePath</td><td>The full path for the <MadCap:variable name="Imaging.Image Delivery server" /> SOAP service manifest file, which is in XML format.</td></tr><tr><td class="InputTextVariable">CoreServiceManifestFilePath</td><td>The full path for the <MadCap:variable name="Imaging.Image Delivery server" /> SOAP service manifest file, which is in XML format.</td></tr></tbody></table></li>
            <li>Create a <MadCap:variable name="FeatureName.virtual schema" /> by running the following command:<p class="InputText">New-AmVirtualSchema -ApplicationInstanceName <span class="InputTextVariable">AppInstanceName </span>-<span class="InputText">DataHostInstanceName </span><span class="InputTextVariable">DataHostInstanceName</span></p><table style="width: 95%; margin-left: 0; margin-right: auto;"><col /><col /><thead><tr><th>Placeholder	</th><th>Value</th></tr></thead><tbody><tr><td class="InputTextVariable">AppInstanceName</td><td>The instance name for the Imaging Registry and Document application.</td></tr><tr><td class="InputTextVariable">DataHostInstanceName</td><td>The fully qualified domain name for the machine where the <MadCap:variable name="BrandingHSG.AmalgaV3 first use" /> clinical database is installed. This value is the fully qualified domain name of the local machine if <MadCap:variable name="BrandingHSG.Amalga Short" /> is installed in a single computer.</td></tr></tbody></table></li>
            <li>Add appropriate role to imaging user access level by running the following command :<p class="InputText">Add-AmRoleToAccessLevel -ApplicationOrFeatureInstanceName <span class="InputTextVariable">AppInstanceName </span>-AccessLevelName ImagingUser -Roles <span class="InputTextVariable">Roles</span></p><table style="width: 95%; margin-left: 0; margin-right: auto;"><col /><col /><thead><tr><th>Placeholder	</th><th>Value</th></tr></thead><tbody><tr><td class="InputTextVariable">AppInstanceName</td><td>The instance name for the IDA.</td></tr><tr><td class="InputTextVariable">Roles</td><td>Appropriate value for the parameter Roles, for example, BUILTIN\AmalgaUsers.</td></tr></tbody></table></li>
            <li>Run the following command:<p class="InputText">Sync-AmPhysicalHost</p></li>
            <li>Run the following command to provide IDA with the connection string to access <MadCap:variable name="BrandingHSG.AmalgaV2" /> imaging databases.<p class="InputText">Set-AmConfigurationSetting -InstanceType ApplicationInstance -InstanceName <span class="InputTextVariable">AppInstanceName </span>-SettingName DataDbConnectionString -SettingValue "Data Source=<span class="InputTextVariable">V2ImagingDatabaseServer</span>;Initial Catalog=DicomMetadata;Integrated Security=true;"</p><table style="width: 95%; margin-left: 0; margin-right: auto;"><col /><col /><thead><tr><th>Placeholder	</th><th>Value</th></tr></thead><tbody><tr><td class="InputTextVariable">AppInstanceName</td><td>The instance name for the IDA.</td></tr><tr><td class="InputTextVariable">V2ImagingDatabaseServer</td><td>The database server name where the <MadCap:variable name="BrandingHSG.AmalgaV2" /> imaging databases are hosted.</td></tr></tbody></table></li>
        </ol>
        <p class="note">You must grant the account used by the IDA access to the <MadCap:variable name="Imaging.DicomBlobData database" /> and <MadCap:variable name="Imaging.DicomMetaData Database" /> databases. See<MadCap:snippetText src="../../Resources/Snippets/mref-Imaging.flsnp" />  in <MadCap:variable name="BrandingHSG.AmalgaV2" />2009 documentation for further details.</p>
        <p class="LabelforProcedures"><a name="To install the RESTful Service"></a>To install the <MadCap:variable name="Imaging.Image Delivery server" /> <![CDATA[ ]]><MadCap:variable name="TechnicalTerms.RESTful" /> Service</p>
        <ol>
            <li>Navigate to Microsoft Health Hosted Services 3.0 in <MadCap:variable name="BrandingMS.Internet Information Services (IIS)" />. After the application sync is complete, follow these steps on each node that comprises the logical host or hosts hosting one or more IDAs.</li>
            <li>Go to the node that represents the IDS SOAP service. The name of the IDS SOAP service is specified in the resolved service manifest file.</li>
            <li>Find <span class="Label">SetupImageDeliveryRESTService.ps1</span> script included in the bin folder.</li>
            <li>Run the following command to set up the <MadCap:variable name="Imaging.Image Delivery server" /> <![CDATA[ ]]><MadCap:variable name="TechnicalTerms.REST" /> service:<p class="InputText">.\SetupImageDeliveryRestService.ps1 -Install -RestServiceInstanceName <span class="InputTextVariable">RestServiceInstanceName </span>-ImageDeliveryApplicationInstanceName <span class="InputTextVariable">ImageDeliveryApplicationInstanceName</span></p><table style="width: 95%; margin-left: 0; margin-right: auto;"><col /><col /><thead><tr><th>Placeholder	</th><th>Value</th></tr></thead><tbody><tr><td class="InputTextVariable">RestServiceInstanceName</td><td>The instance name for the respective <MadCap:variable name="Imaging.Image Delivery server" /> <![CDATA[ ]]><MadCap:variable name="TechnicalTerms.REST" /> service instance.</td></tr><tr><td class="InputTextVariable">ImageDeliveryApplicationInstanceName</td><td>The instance name for the respective IDA instance.</td></tr></tbody></table><p class="note">This script will override the existing <MadCap:variable name="Imaging.Image Delivery server" /> <![CDATA[ ]]><MadCap:variable name="TechnicalTerms.REST" /> service bits if the <MadCap:variable name="TechnicalTerms.REST" /> service has been installed on the respective machine before.</p><p class="note">You can also install the IDA by using <MadCap:variable name="FeatureName.Microsoft Amalga Management Console" />. For more information, see <MadCap:xref href="../../Serviceability/Management Console/Application Management/Application Deployment.htm">Application deployment on page 1</MadCap:xref>. Using the console will still require you to install the <MadCap:variable name="Imaging.Image Delivery server" /> <![CDATA[ ]]><MadCap:variable name="TechnicalTerms.REST" /> service using the instructions in this topic.</p></li>
        </ol>
        <p class="SeeAlso" MadCap:conditions="">See also</p>
        <p MadCap:conditions="">
            <MadCap:xref href="LAN-MIM-Dep.htm">Installation steps on page 1</MadCap:xref>
        </p>
        <p MadCap:conditions="">
            <MadCap:xref href="../../PowerShellCmdlets/PS_Ref_Publish-AmApplicatioinInstance.htm">Publish-AmApplicationInstance on page 1</MadCap:xref>.</p>
    </body>
</html>